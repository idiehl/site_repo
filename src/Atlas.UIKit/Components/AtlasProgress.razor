@namespace Atlas.UIKit.Components

<div class="atlas-progress @VariantClass" role="progressbar"
     aria-valuenow="@ClampedValue" aria-valuemin="0" aria-valuemax="100"
     @attributes="AdditionalAttributes">
    @if (!string.IsNullOrWhiteSpace(Label) || ShowValue)
    {
        <div class="atlas-progress__header">
            @if (!string.IsNullOrWhiteSpace(Label))
            {
                <span class="atlas-progress__label">@Label</span>
            }
            @if (ShowValue)
            {
                <span class="atlas-progress__value">@ClampedValue%</span>
            }
        </div>
    }
    <div class="atlas-progress__track">
        <div class="atlas-progress__fill" style="width: @(ClampedValue)%"></div>
    </div>
</div>

@code {
    [Parameter] public int Value { get; set; }
    [Parameter] public string Variant { get; set; } = "standard";
    [Parameter] public string? Label { get; set; }
    [Parameter] public bool ShowValue { get; set; } = true;
    [Parameter(CaptureUnmatchedValues = true)] public Dictionary<string, object>? AdditionalAttributes { get; set; }

    private int ClampedValue => Math.Clamp(Value, 0, 100);

    private string VariantClass => Variant switch
    {
        "gold" => "atlas-progress--gold",
        "celestial" => "atlas-progress--celestial",
        _ => "atlas-progress--standard"
    };
}
