import{u as V,r as c,x as D,m as L,c as l,a as t,h,i as _,j as N,t as a,f as y,e as k,C as S,b as R,F as U,n as F,s as C,o as i,g as f,p as b}from"./index-CIB9YAYq.js";const B={class:"min-h-screen bg-night-950"},M={class:"bg-night-900/50 border-b border-night-800"},O={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},T={class:"flex items-center justify-between h-16"},j={class:"flex items-center gap-4"},$={class:"hidden md:flex items-center gap-1"},z={class:"flex items-center gap-4"},H={class:"text-sm text-night-400"},I={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},P={key:0,class:"card bg-red-900/20 border-red-800"},Y={key:1},q={class:"card mb-6"},G={class:"flex items-center gap-4 flex-wrap"},J=["disabled"],K={key:0,class:"card"},Q={key:1,class:"card bg-red-900/20 border-red-800"},W={class:"text-red-400"},X={key:2,class:"card"},Z={key:3,class:"card"},tt={class:"overflow-x-auto"},et={class:"w-full text-sm"},st={class:"p-2 font-mono text-xs"},ot={class:"p-2"},lt={class:"p-2 text-xs"},it={class:"p-2 text-xs"},at={class:"p-2 text-xs"},nt={class:"p-2"},dt={class:"p-2"},rt=["onClick"],ut={key:1,class:"text-xs text-night-500"},vt={__name:"AdminSecurityView",setup(ct){const p=V(),x=c(!0),g=c([]),r=c(null),v=c(null),m=c(null),w=D(()=>{var n;return((n=p.user)==null?void 0:n.is_admin)===!0}),A={low:"text-blue-400",medium:"text-yellow-400",high:"text-orange-400",critical:"text-red-400"};async function u(){var n,e;x.value=!0,r.value=null;try{const o={};v.value!==null&&(o.resolved=v.value),m.value&&(o.severity=m.value);const d=await C.get("/api/v1/admin/security/events",{params:o});g.value=d.data.events||[]}catch(o){r.value=((e=(n=o.response)==null?void 0:n.data)==null?void 0:e.detail)||"Failed to load security events"}finally{x.value=!1}}async function E(n){var e,o;try{await C.post(`/api/v1/admin/security/events/${n}/resolve`),await u()}catch(d){r.value=((o=(e=d.response)==null?void 0:e.data)==null?void 0:o.detail)||"Failed to resolve event"}}return L(()=>{w.value&&u()}),(n,e)=>{var d;const o=N("router-link");return i(),l("div",B,[t("header",M,[t("div",O,[t("div",T,[t("div",j,[e[6]||(e[6]=t("h1",{class:"text-xl font-bold text-atlas-400"},"Security Events",-1)),t("nav",$,[h(o,{to:"/admin",class:"px-3 py-2 rounded-lg text-sm font-medium text-night-400 hover:text-night-100 hover:bg-night-800/50"},{default:_(()=>[...e[3]||(e[3]=[f(" Overview ",-1)])]),_:1}),h(o,{to:"/admin/analytics",class:"px-3 py-2 rounded-lg text-sm font-medium text-night-400 hover:text-night-100 hover:bg-night-800/50"},{default:_(()=>[...e[4]||(e[4]=[f(" Analytics ",-1)])]),_:1}),h(o,{to:"/admin/security",class:"px-3 py-2 rounded-lg text-sm font-medium text-night-100 bg-night-800"},{default:_(()=>[...e[5]||(e[5]=[f(" Security ",-1)])]),_:1})])]),t("div",z,[t("span",H,a((d=y(p).user)==null?void 0:d.email),1),t("button",{onClick:e[0]||(e[0]=(...s)=>y(p).logout&&y(p).logout(...s)),class:"btn btn-ghost text-sm"}," Logout ")])])])]),t("main",I,[w.value?(i(),l("div",Y,[t("div",q,[t("div",G,[e[10]||(e[10]=t("label",{class:"text-sm text-night-400"},"Status:",-1)),k(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>v.value=s),onChange:u,class:"input"},[...e[8]||(e[8]=[t("option",{value:null},"All",-1),t("option",{value:!1},"Unresolved",-1),t("option",{value:!0},"Resolved",-1)])],544),[[S,v.value]]),e[11]||(e[11]=t("label",{class:"text-sm text-night-400 ml-4"},"Severity:",-1)),k(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>m.value=s),onChange:u,class:"input"},[...e[9]||(e[9]=[R('<option value="">All</option><option value="low">Low</option><option value="medium">Medium</option><option value="high">High</option><option value="critical">Critical</option>',5)])],544),[[S,m.value]]),t("button",{onClick:u,class:"btn btn-primary",disabled:x.value}," Refresh ",8,J)])]),x.value?(i(),l("div",K,[...e[12]||(e[12]=[t("p",{class:"text-night-400"},"Loading security events...",-1)])])):r.value?(i(),l("div",Q,[t("p",W,a(r.value),1)])):g.value.length===0?(i(),l("div",X,[...e[13]||(e[13]=[t("p",{class:"text-night-400"},"No security events found.",-1)])])):(i(),l("div",Z,[e[15]||(e[15]=t("h2",{class:"text-xl font-bold mb-4"},"Security Events",-1)),t("div",tt,[t("table",et,[e[14]||(e[14]=t("thead",null,[t("tr",{class:"border-b border-night-800"},[t("th",{class:"text-left p-2"},"Type"),t("th",{class:"text-left p-2"},"Severity"),t("th",{class:"text-left p-2"},"IP Address"),t("th",{class:"text-left p-2"},"User"),t("th",{class:"text-left p-2"},"Time"),t("th",{class:"text-left p-2"},"Status"),t("th",{class:"text-left p-2"},"Actions")])],-1)),t("tbody",null,[(i(!0),l(U,null,F(g.value,s=>(i(),l("tr",{key:s.id,class:b(["border-b border-night-800/50",s.severity==="critical"&&!s.resolved?"bg-red-900/10":""])},[t("td",st,a(s.event_type),1),t("td",ot,[t("span",{class:b(A[s.severity]||"text-night-400")},a(s.severity.toUpperCase()),3)]),t("td",lt,a(s.ip_address||"-"),1),t("td",it,a(s.user_id||"Anonymous"),1),t("td",at,a(new Date(s.created_at).toLocaleString()),1),t("td",nt,[t("span",{class:b([s.resolved?"text-green-400":"text-yellow-400","text-xs font-semibold"])},a(s.resolved?"RESOLVED":"UNRESOLVED"),3)]),t("td",dt,[s.resolved?(i(),l("span",ut,a(s.resolved_at?new Date(s.resolved_at).toLocaleDateString():""),1)):(i(),l("button",{key:0,onClick:pt=>E(s.id),class:"btn btn-sm btn-primary"}," Resolve ",8,rt))])],2))),128))])])])]))])):(i(),l("div",P,[...e[7]||(e[7]=[t("h2",{class:"text-xl font-bold text-red-400 mb-2"},"Access Denied",-1),t("p",{class:"text-night-300"},"You do not have admin privileges.",-1)])]))])])}}};export{vt as default};
