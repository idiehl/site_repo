import{_ as z}from"./quickpro-icon-BEYmoaV4.js";import{k as N,r as h,m as V,c as l,o,a as t,F as M,n as B,t as d,h as w,p as L,d as A,e as P,v as U,q as K,f as b,w as q,s as F,u as E,x as I,y as T,z as O,A as W,i as R,j as G,g as j}from"./index-tJy5BnYm.js";import{u as S,_ as Q}from"./StatusBadge-CL-G9wft.js";import{u as H}from"./applications-p5Nhg3Kc.js";const X={key:0,class:"text-center py-12"},Y={key:1,class:"text-center py-12"},Z={key:2,class:"overflow-x-auto"},tt={class:"w-full"},et=["onClick"],st={class:"py-3 px-4"},ot={class:"font-medium"},nt={class:"py-3 px-4"},lt={class:"text-night-300"},at={class:"py-3 px-4"},it={class:"text-night-400 text-sm"},rt={class:"py-3 px-4"},dt={class:"py-3 px-4"},ut={key:1,class:"text-night-600 text-sm"},ct={class:"py-3 px-4"},pt={class:"text-night-400 text-sm"},xt={class:"py-3 px-4 text-right"},gt=["onClick","disabled"],bt={__name:"JobTable",props:{jobs:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(J,{emit:$}){const p=J,i=$,c=N(),m=S(),r=H(),u=h(null),f={pending:{label:"Saved",color:"bg-gray-500/20 text-gray-300 border border-gray-500/30"},applied:{label:"Applied",color:"bg-blue-500/20 text-blue-300 border border-blue-500/30"},followup_scheduled:{label:"Follow-up",color:"bg-yellow-500/20 text-yellow-300 border border-yellow-500/30"},interview_scheduled:{label:"Interview",color:"bg-purple-500/20 text-purple-300 border border-purple-500/30"},offer_received:{label:"Offer",color:"bg-green-500/20 text-green-300 border border-green-500/30"},rejected:{label:"Rejected",color:"bg-red-500/20 text-red-300 border border-red-500/30"},withdrawn:{label:"Withdrawn",color:"bg-gray-500/20 text-gray-400 border border-gray-500/30"},no_response_closed:{label:"No Response",color:"bg-gray-500/20 text-gray-400 border border-gray-500/30"}};function g(a){return r.getApplicationForJob(a)}function x(a){const e=g(a);return e?f[e.status]||{label:e.status,color:"bg-gray-500/20 text-gray-300"}:null}V(()=>{r.fetchApplications()});function v(a){c.push(`/jobs/${a.id}`)}async function k(a,e){a.stopPropagation(),u.value=e.id;const s=await m.deleteJob(e.id);u.value=null,s&&i("refresh")}function C(a){return a?new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"-"}return(a,e)=>(o(),l("div",null,[J.loading&&!p.jobs.length?(o(),l("div",X,[...e[0]||(e[0]=[t("div",{class:"inline-block animate-spin w-8 h-8 border-2 border-night-600 border-t-atlas-500 rounded-full"},null,-1),t("p",{class:"text-night-400 mt-2"},"Loading jobs...",-1)])])):p.jobs.length?(o(),l("div",Z,[t("table",tt,[e[2]||(e[2]=t("thead",null,[t("tr",{class:"border-b border-night-800"},[t("th",{class:"text-left py-3 px-4 text-sm font-medium text-night-400"},"Company"),t("th",{class:"text-left py-3 px-4 text-sm font-medium text-night-400"},"Position"),t("th",{class:"text-left py-3 px-4 text-sm font-medium text-night-400"},"Location"),t("th",{class:"text-left py-3 px-4 text-sm font-medium text-night-400"},"Status"),t("th",{class:"text-left py-3 px-4 text-sm font-medium text-night-400"},"Application"),t("th",{class:"text-left py-3 px-4 text-sm font-medium text-night-400"},"Added"),t("th",{class:"text-right py-3 px-4 text-sm font-medium text-night-400"},"Actions")])],-1)),t("tbody",null,[(o(!0),l(M,null,B(p.jobs,s=>(o(),l("tr",{key:s.id,class:"border-b border-night-800/50 hover:bg-night-800/30 cursor-pointer transition-colors",onClick:n=>v(s)},[t("td",st,[t("span",ot,d(s.company_name||"Processing..."),1)]),t("td",nt,[t("span",lt,d(s.job_title||"-"),1)]),t("td",at,[t("span",it,d(s.location||"-"),1)]),t("td",rt,[w(Q,{status:s.status},null,8,["status"])]),t("td",dt,[x(s.id)?(o(),l("span",{key:0,class:L(["px-2 py-1 rounded text-xs font-medium",x(s.id).color])},d(x(s.id).label),3)):(o(),l("span",ut,"â€”"))]),t("td",ct,[t("span",pt,d(C(s.created_at)),1)]),t("td",xt,[t("button",{onClick:n=>k(n,s),disabled:u.value===s.id,class:"text-red-400 hover:text-red-300 hover:bg-red-900/30 px-2 py-1 rounded text-sm transition-colors disabled:opacity-50",title:"Delete job"},d(u.value===s.id?"...":"ðŸ—‘ï¸"),9,gt)])],8,et))),128))])])])):(o(),l("div",Y,[...e[1]||(e[1]=[t("div",{class:"text-4xl mb-4"},"ðŸ“‹",-1),t("h3",{class:"text-lg font-medium text-night-300 mb-2"},"No jobs yet",-1),t("p",{class:"text-night-500"},"Add job URLs to start building your pipeline",-1)])]))]))}},mt={class:"bg-night-900 border border-night-800 rounded-xl w-full max-w-lg shadow-2xl animate-fade-in"},ht={class:"flex items-center justify-between p-6 border-b border-night-800"},ft={class:"p-6"},vt={class:"flex gap-2 mb-4"},yt={key:0},_t={class:"flex gap-2 mb-4"},wt={key:0,class:"space-y-2 mb-4 max-h-48 overflow-y-auto"},$t={class:"flex-1 text-sm text-night-300 truncate"},kt=["onClick"],Ct={key:1,class:"text-center py-6 bg-night-800/30 rounded-lg mb-4"},jt={key:1},At={key:2,class:"text-red-400 text-sm mt-4"},Jt={key:3,class:"text-red-400 text-sm mt-2"},Rt={class:"flex items-center justify-end gap-3 p-6 border-t border-night-800"},Pt=["disabled"],Ut={key:0},Lt={key:1},St={key:2},Dt={__name:"IngestModal",emits:["close","success"],setup(J,{emit:$}){const p=$,i=S(),c=h("url"),m=h(""),r=h([]),u=h(""),f=h(""),g=h(""),x=h(!1);function v(){const e=m.value.trim();if(e)try{new URL(e),r.value.includes(e)||r.value.push(e),m.value="",g.value=""}catch{g.value="Please enter a valid URL"}}function k(e){r.value=r.value.filter(s=>s!==e)}async function C(){var e,s,n,y;g.value="",x.value=!0;try{if(c.value==="url"){if(!r.value.length){g.value="Add at least one URL",x.value=!1;return}await i.ingestJobs(r.value)&&p("success")}else{if(!u.value.trim()||u.value.trim().length<50){g.value="Please paste the job description (at least 50 characters)",x.value=!1;return}const _=f.value.trim()||`manual-entry-${Date.now()}`,D=await F.post("/api/v1/jobs/ingest",{urls:[_.startsWith("http")?_:`https://manual-entry.local/${_}`]});(s=(e=D.data)==null?void 0:e.job_ids)!=null&&s.length&&await F.post(`/api/v1/jobs/${D.data.job_ids[0]}/manual-content`,{content:u.value}),p("success")}}catch(_){g.value=((y=(n=_.response)==null?void 0:n.data)==null?void 0:y.detail)||"Failed to add job"}finally{x.value=!1}}function a(e){e.key==="Escape"&&p("close")}return(e,s)=>(o(),l("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:s[7]||(s[7]=q(n=>p("close"),["self"])),onKeydown:a},[t("div",mt,[t("div",ht,[s[8]||(s[8]=t("h2",{class:"text-lg font-semibold"},"Add Job",-1)),t("button",{onClick:s[0]||(s[0]=n=>p("close")),class:"text-night-400 hover:text-night-100 text-xl"}," Ã— ")]),t("div",ft,[t("div",vt,[t("button",{onClick:s[1]||(s[1]=n=>c.value="url"),class:L(["flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-colors",c.value==="url"?"bg-atlas-600 text-white":"bg-night-800 text-night-400 hover:text-night-200"])}," ðŸ“Ž Paste URL ",2),t("button",{onClick:s[2]||(s[2]=n=>c.value="paste"),class:L(["flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-colors",c.value==="paste"?"bg-atlas-600 text-white":"bg-night-800 text-night-400 hover:text-night-200"])}," ðŸ“ Paste Description ",2)]),c.value==="url"?(o(),l("div",yt,[s[10]||(s[10]=t("p",{class:"text-night-400 text-sm mb-4"}," Paste job posting URLs to save them to your list. ",-1)),t("div",_t,[P(t("input",{"onUpdate:modelValue":s[3]||(s[3]=n=>m.value=n),type:"url",class:"flex-1",placeholder:"https://linkedin.com/jobs/...",onKeyup:K(v,["enter"])},null,544),[[U,m.value]]),t("button",{onClick:v,class:"btn btn-secondary"}," Add ")]),r.value.length?(o(),l("div",wt,[(o(!0),l(M,null,B(r.value,n=>(o(),l("div",{key:n,class:"flex items-center gap-2 p-2 bg-night-800/50 rounded-lg"},[t("span",$t,d(n),1),t("button",{onClick:y=>k(n),class:"text-night-500 hover:text-red-400 text-sm"}," Remove ",8,kt)]))),128))])):(o(),l("div",Ct,[...s[9]||(s[9]=[t("p",{class:"text-night-500 text-sm"},"No URLs added yet",-1)])]))])):(o(),l("div",jt,[s[11]||(s[11]=t("p",{class:"text-night-400 text-sm mb-4"}," Copy and paste the job description directly. Great for sites we can't auto-import from. ",-1)),P(t("input",{"onUpdate:modelValue":s[4]||(s[4]=n=>f.value=n),type:"text",class:"w-full mb-3",placeholder:"Source URL (optional)"},null,512),[[U,f.value]]),P(t("textarea",{"onUpdate:modelValue":s[5]||(s[5]=n=>u.value=n),class:"w-full h-48 bg-night-800 border border-night-700 rounded-lg p-3 text-sm resize-none focus:outline-none focus:border-atlas-500",placeholder:"Paste the job title, company name, description, requirements, etc..."},null,512),[[U,u.value]]),s[12]||(s[12]=t("p",{class:"text-night-500 text-xs mt-2"}," Include: job title, company name, location, requirements, and description for best results. ",-1))])),g.value?(o(),l("p",At,d(g.value),1)):A("",!0),b(i).error?(o(),l("p",Jt,d(b(i).error),1)):A("",!0)]),t("div",Rt,[t("button",{onClick:s[6]||(s[6]=n=>p("close")),class:"btn btn-ghost"}," Cancel "),t("button",{onClick:C,class:"btn btn-primary",disabled:x.value||c.value==="url"&&!r.value.length||c.value==="paste"&&!u.value.trim()},[x.value?(o(),l("span",Ut,"Processing...")):c.value==="url"?(o(),l("span",Lt,"Add "+d(r.value.length)+" Job"+d(r.value.length!==1?"s":""),1)):(o(),l("span",St,"Add Job"))],8,Pt)])])],32))}},Ft={class:"min-h-screen"},It={class:"bg-night-900/50 border-b border-night-800"},Nt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Vt={class:"flex items-center justify-between h-16"},Mt={class:"flex items-center gap-4"},Bt={class:"hidden md:flex items-center gap-1"},zt={class:"flex items-center gap-4"},Kt={class:"text-sm text-night-400"},qt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Et={class:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-8"},Tt={class:"card"},Ot={class:"text-2xl font-bold"},Wt={class:"card"},Gt={class:"text-2xl font-bold text-yellow-400"},Qt={class:"card"},Ht={class:"text-2xl font-bold text-green-400"},Xt={class:"card"},Yt={class:"text-2xl font-bold text-orange-400"},Zt={class:"card"},te={class:"flex items-center gap-2"},ee={class:"text-2xl font-bold text-red-400"},se=["disabled"],oe={class:"card"},ne={class:"flex items-center justify-between mb-6"},le={class:"flex items-center gap-3"},ae={key:0,class:"flex items-center gap-2 text-xs text-night-400 bg-night-800 px-2 py-1 rounded-full"},ce={__name:"DashboardView",setup(J){const $=N(),p=E(),i=S(),c=h(!1),m=h(!1),r=h(!1);let u=null;const f=I(()=>i.jobs.some(a=>a.status==="pending"||a.status==="processing")),g=I(()=>i.jobs.filter(a=>a.status==="needs_review").length);function x(){u||(r.value=!0,u=setInterval(async()=>{await i.fetchJobs(),f.value||v()},5e3))}function v(){u&&(clearInterval(u),u=null),r.value=!1}T(f,a=>{a?x():v()}),V(async()=>{await i.fetchJobs(),f.value&&x()}),O(()=>{v()});function k(){p.logout(),$.push({name:"login"})}async function C(){m.value=!0;try{await i.retryAllFailed()}finally{m.value=!1}}return(a,e)=>{var n;const s=G("router-link");return o(),l("div",Ft,[t("header",It,[t("div",Nt,[t("div",Vt,[t("div",Mt,[e[7]||(e[7]=t("div",{class:"flex items-center"},[t("img",{src:z,alt:"Q",class:"w-8 h-8 -mr-0.5"}),t("h1",{class:"text-xl font-bold text-atlas-400"},"uickPRO")],-1)),t("nav",Bt,[w(s,{to:"/dashboard",class:"px-3 py-2 rounded-lg text-sm font-medium text-night-100 bg-night-800"},{default:R(()=>[...e[3]||(e[3]=[j(" Dashboard ",-1)])]),_:1}),w(s,{to:"/applications",class:"px-3 py-2 rounded-lg text-sm font-medium text-night-400 hover:text-night-100 hover:bg-night-800/50"},{default:R(()=>[...e[4]||(e[4]=[j(" Applications ",-1)])]),_:1}),w(s,{to:"/profile",class:"px-3 py-2 rounded-lg text-sm font-medium text-night-400 hover:text-night-100 hover:bg-night-800/50"},{default:R(()=>[...e[5]||(e[5]=[j(" Profile ",-1)])]),_:1}),w(s,{to:"/extension",class:"px-3 py-2 rounded-lg text-sm font-medium text-night-400 hover:text-night-100 hover:bg-night-800/50"},{default:R(()=>[...e[6]||(e[6]=[j(" Extension ",-1)])]),_:1})])]),t("div",zt,[t("span",Kt,d((n=b(p).user)==null?void 0:n.email),1),t("button",{onClick:k,class:"btn btn-ghost text-sm"}," Logout ")])])])]),t("main",qt,[t("div",Et,[t("div",Tt,[e[8]||(e[8]=t("p",{class:"text-sm text-night-400 mb-1"},"Saved Jobs",-1)),t("p",Ot,d(b(i).jobs.length),1)]),t("div",Wt,[e[9]||(e[9]=t("p",{class:"text-sm text-night-400 mb-1"},"Processing",-1)),t("p",Gt,d(b(i).pendingJobs.length),1)]),t("div",Qt,[e[10]||(e[10]=t("p",{class:"text-sm text-night-400 mb-1"},"Ready",-1)),t("p",Ht,d(b(i).completedJobs.length),1)]),t("div",Xt,[e[11]||(e[11]=t("p",{class:"text-sm text-night-400 mb-1"},"Needs Review",-1)),t("p",Yt,d(g.value),1)]),t("div",Zt,[e[12]||(e[12]=t("p",{class:"text-sm text-night-400 mb-1"},"Failed",-1)),t("div",te,[t("p",ee,d(b(i).failedJobs.length),1),b(i).failedJobs.length>0?(o(),l("button",{key:0,onClick:C,disabled:m.value,class:"text-xs px-2 py-1 bg-red-600 hover:bg-red-500 rounded text-white disabled:opacity-50"},d(m.value?"Retrying...":"Retry All"),9,se)):A("",!0)])]),e[13]||(e[13]=t("div",{class:"card"},[t("p",{class:"text-sm text-night-400 mb-1"},"Applications"),t("p",{class:"text-2xl font-bold text-atlas-400"},"0")],-1))]),t("div",oe,[t("div",ne,[t("div",le,[e[15]||(e[15]=t("h2",{class:"text-lg font-semibold"},"My Jobs",-1)),r.value?(o(),l("span",ae,[...e[14]||(e[14]=[t("span",{class:"w-2 h-2 bg-green-500 rounded-full animate-pulse"},null,-1),j(" Auto-refreshing ",-1)])])):A("",!0)]),t("button",{onClick:e[0]||(e[0]=y=>c.value=!0),class:"btn btn-accent"}," + Add Jobs ")]),w(bt,{jobs:b(i).jobs,loading:b(i).loading,onRefresh:b(i).fetchJobs},null,8,["jobs","loading","onRefresh"])])]),c.value?(o(),W(Dt,{key:0,onClose:e[1]||(e[1]=y=>c.value=!1),onSuccess:e[2]||(e[2]=y=>{b(i).fetchJobs(),c.value=!1})})):A("",!0)])}}};export{ce as default};
