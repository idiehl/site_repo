import{_ as B}from"./quickpro-icon-BEYmoaV4.js";import{k as z,r as m,m as N,c as i,o as l,a as t,F as V,n as M,t as d,h as $,p as L,d as j,e as P,v as U,q as K,f as g,w as q,s as F,u as E,x as I,y as T,z as O,A as W,i as J,j as G,g as C}from"./index-CIB9YAYq.js";import{u as S,_ as Q}from"./StatusBadge-Diy1jCeW.js";import{u as H}from"./applications-DvlyoE9f.js";const X={key:0,class:"text-center py-12"},Y={key:1,class:"text-center py-12"},Z={key:2,class:"overflow-x-auto"},tt={class:"w-full"},et=["onClick"],st={class:"py-3 px-4"},ot={class:"font-medium"},nt={class:"py-3 px-4"},lt={class:"text-night-300"},at={class:"py-3 px-4"},it={class:"text-night-400 text-sm"},rt={class:"py-3 px-4"},dt={class:"py-3 px-4"},ut={key:1,class:"text-night-600 text-sm"},ct={class:"py-3 px-4"},pt={class:"text-night-400 text-sm"},xt={class:"py-3 px-4 text-right"},gt=["onClick","disabled"],bt={__name:"JobTable",props:{jobs:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(A,{emit:y}){const n=A,h=y,u=z(),f=S(),r=H(),c=m(null),v={pending:{label:"Saved",color:"bg-gray-500/20 text-gray-300 border border-gray-500/30"},applied:{label:"Applied",color:"bg-blue-500/20 text-blue-300 border border-blue-500/30"},followup_scheduled:{label:"Follow-up",color:"bg-yellow-500/20 text-yellow-300 border border-yellow-500/30"},interview_scheduled:{label:"Interview",color:"bg-purple-500/20 text-purple-300 border border-purple-500/30"},offer_received:{label:"Offer",color:"bg-green-500/20 text-green-300 border border-green-500/30"},rejected:{label:"Rejected",color:"bg-red-500/20 text-red-300 border border-red-500/30"},withdrawn:{label:"Withdrawn",color:"bg-gray-500/20 text-gray-400 border border-gray-500/30"},no_response_closed:{label:"No Response",color:"bg-gray-500/20 text-gray-400 border border-gray-500/30"}};function x(s){return r.getApplicationForJob(s)}function p(s){const o=x(s);return o?v[o.status]||{label:o.status,color:"bg-gray-500/20 text-gray-300"}:null}N(()=>{r.fetchApplications()});function _(s){u.push(`/jobs/${s.id}`)}async function k(s,o){s.stopPropagation(),c.value=o.id;const e=await f.deleteJob(o.id);c.value=null,e&&h("refresh")}function b(s){return s?new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"-"}return(s,o)=>(l(),i("div",null,[A.loading&&!n.jobs.length?(l(),i("div",X,[...o[0]||(o[0]=[t("div",{class:"inline-block animate-spin w-8 h-8 border-2 border-night-600 border-t-atlas-500 rounded-full"},null,-1),t("p",{class:"text-night-400 mt-2"},"Loading jobs...",-1)])])):n.jobs.length?(l(),i("div",Z,[t("table",tt,[o[2]||(o[2]=t("thead",null,[t("tr",{class:"border-b border-night-800"},[t("th",{class:"text-left py-3 px-4 text-sm font-medium text-night-400"},"Company"),t("th",{class:"text-left py-3 px-4 text-sm font-medium text-night-400"},"Position"),t("th",{class:"text-left py-3 px-4 text-sm font-medium text-night-400"},"Location"),t("th",{class:"text-left py-3 px-4 text-sm font-medium text-night-400"},"Status"),t("th",{class:"text-left py-3 px-4 text-sm font-medium text-night-400"},"Application"),t("th",{class:"text-left py-3 px-4 text-sm font-medium text-night-400"},"Added"),t("th",{class:"text-right py-3 px-4 text-sm font-medium text-night-400"},"Actions")])],-1)),t("tbody",null,[(l(!0),i(V,null,M(n.jobs,e=>(l(),i("tr",{key:e.id,class:"border-b border-night-800/50 hover:bg-night-800/30 cursor-pointer transition-colors",onClick:a=>_(e)},[t("td",st,[t("span",ot,d(e.company_name||"Processing..."),1)]),t("td",nt,[t("span",lt,d(e.job_title||"-"),1)]),t("td",at,[t("span",it,d(e.location||"-"),1)]),t("td",rt,[$(Q,{status:e.status},null,8,["status"])]),t("td",dt,[p(e.id)?(l(),i("span",{key:0,class:L(["px-2 py-1 rounded text-xs font-medium",p(e.id).color])},d(p(e.id).label),3)):(l(),i("span",ut,"â€”"))]),t("td",ct,[t("span",pt,d(b(e.created_at)),1)]),t("td",xt,[t("button",{onClick:a=>k(a,e),disabled:c.value===e.id,class:"text-red-400 hover:text-red-300 hover:bg-red-900/30 px-2 py-1 rounded text-sm transition-colors disabled:opacity-50",title:"Delete job"},d(c.value===e.id?"...":"ðŸ—‘ï¸"),9,gt)])],8,et))),128))])])])):(l(),i("div",Y,[...o[1]||(o[1]=[t("div",{class:"text-4xl mb-4"},"ðŸ“‹",-1),t("h3",{class:"text-lg font-medium text-night-300 mb-2"},"No jobs yet",-1),t("p",{class:"text-night-500"},"Add job URLs to start building your pipeline",-1)])]))]))}},mt={class:"bg-night-900 border border-night-800 rounded-xl w-full max-w-lg shadow-2xl animate-fade-in"},ht={class:"flex items-center justify-between p-6 border-b border-night-800"},ft={class:"p-6"},vt={class:"flex gap-2 mb-4"},yt={key:0},_t={class:"flex gap-2 mb-4"},wt={key:0,class:"space-y-2 mb-4 max-h-48 overflow-y-auto"},$t={class:"flex-1 text-sm text-night-300 truncate"},kt=["onClick"],Ct={key:1,class:"text-center py-6 bg-night-800/30 rounded-lg mb-4"},jt={key:1},At={key:2,class:"text-red-400 text-sm mt-4"},Jt={key:3,class:"text-red-400 text-sm mt-2"},Rt={class:"flex items-center justify-end gap-3 p-6 border-t border-night-800"},Pt=["disabled"],Ut={key:0},Lt={key:1},St={key:2},Dt={__name:"IngestModal",emits:["close","success"],setup(A,{emit:y}){const n=y,h=S(),u=m("url"),f=m(""),r=m([]),c=m(""),v=m(""),x=m(""),p=m(!1);function _(){const o=f.value.trim();if(o)try{new URL(o),r.value.includes(o)||r.value.push(o),f.value="",x.value=""}catch{x.value="Please enter a valid URL"}}function k(o){r.value=r.value.filter(e=>e!==o)}async function b(){var o,e,a,R;x.value="",p.value=!0;try{if(u.value==="url"){if(!r.value.length){x.value="Add at least one URL",p.value=!1;return}await h.ingestJobs(r.value)&&n("success")}else{if(!c.value.trim()||c.value.trim().length<50){x.value="Please paste the job description (at least 50 characters)",p.value=!1;return}const w=v.value.trim()||`manual-entry-${Date.now()}`,D=await F.post("/api/v1/jobs/ingest",{urls:[w.startsWith("http")?w:`https://manual-entry.local/${w}`]});(e=(o=D.data)==null?void 0:o.job_ids)!=null&&e.length&&await F.post(`/api/v1/jobs/${D.data.job_ids[0]}/manual-content`,{content:c.value}),n("success")}}catch(w){x.value=((R=(a=w.response)==null?void 0:a.data)==null?void 0:R.detail)||"Failed to add job"}finally{p.value=!1}}function s(o){o.key==="Escape"&&n("close")}return(o,e)=>(l(),i("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:e[7]||(e[7]=q(a=>n("close"),["self"])),onKeydown:s},[t("div",mt,[t("div",ht,[e[8]||(e[8]=t("h2",{class:"text-lg font-semibold"},"Add Job",-1)),t("button",{onClick:e[0]||(e[0]=a=>n("close")),class:"text-night-400 hover:text-night-100 text-xl"}," Ã— ")]),t("div",ft,[t("div",vt,[t("button",{onClick:e[1]||(e[1]=a=>u.value="url"),class:L(["flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-colors",u.value==="url"?"bg-atlas-600 text-white":"bg-night-800 text-night-400 hover:text-night-200"])}," ðŸ“Ž Paste URL ",2),t("button",{onClick:e[2]||(e[2]=a=>u.value="paste"),class:L(["flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-colors",u.value==="paste"?"bg-atlas-600 text-white":"bg-night-800 text-night-400 hover:text-night-200"])}," ðŸ“ Paste Description ",2)]),u.value==="url"?(l(),i("div",yt,[e[10]||(e[10]=t("p",{class:"text-night-400 text-sm mb-4"}," Paste job posting URLs to save them to your list. ",-1)),t("div",_t,[P(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>f.value=a),type:"url",class:"flex-1",placeholder:"https://linkedin.com/jobs/...",onKeyup:K(_,["enter"])},null,544),[[U,f.value]]),t("button",{onClick:_,class:"btn btn-secondary"}," Add ")]),r.value.length?(l(),i("div",wt,[(l(!0),i(V,null,M(r.value,a=>(l(),i("div",{key:a,class:"flex items-center gap-2 p-2 bg-night-800/50 rounded-lg"},[t("span",$t,d(a),1),t("button",{onClick:R=>k(a),class:"text-night-500 hover:text-red-400 text-sm"}," Remove ",8,kt)]))),128))])):(l(),i("div",Ct,[...e[9]||(e[9]=[t("p",{class:"text-night-500 text-sm"},"No URLs added yet",-1)])]))])):(l(),i("div",jt,[e[11]||(e[11]=t("p",{class:"text-night-400 text-sm mb-4"}," Copy and paste the job description directly. Great for sites we can't auto-import from. ",-1)),P(t("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>v.value=a),type:"text",class:"w-full mb-3",placeholder:"Source URL (optional)"},null,512),[[U,v.value]]),P(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=a=>c.value=a),class:"w-full h-48 bg-night-800 border border-night-700 rounded-lg p-3 text-sm resize-none focus:outline-none focus:border-atlas-500",placeholder:"Paste the job title, company name, description, requirements, etc..."},null,512),[[U,c.value]]),e[12]||(e[12]=t("p",{class:"text-night-500 text-xs mt-2"}," Include: job title, company name, location, requirements, and description for best results. ",-1))])),x.value?(l(),i("p",At,d(x.value),1)):j("",!0),g(h).error?(l(),i("p",Jt,d(g(h).error),1)):j("",!0)]),t("div",Rt,[t("button",{onClick:e[6]||(e[6]=a=>n("close")),class:"btn btn-ghost"}," Cancel "),t("button",{onClick:b,class:"btn btn-primary",disabled:p.value||u.value==="url"&&!r.value.length||u.value==="paste"&&!c.value.trim()},[p.value?(l(),i("span",Ut,"Processing...")):u.value==="url"?(l(),i("span",Lt,"Add "+d(r.value.length)+" Job"+d(r.value.length!==1?"s":""),1)):(l(),i("span",St,"Add Job"))],8,Pt)])])],32))}},Ft={class:"min-h-screen"},It={class:"bg-night-900/50 border-b border-night-800"},Nt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Vt={class:"flex items-center justify-between h-16"},Mt={class:"flex items-center gap-4"},Bt={class:"hidden md:flex items-center gap-1"},zt={class:"flex items-center gap-4"},Kt={class:"text-sm text-night-400"},qt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Et={class:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-8"},Tt={class:"card"},Ot={class:"text-2xl font-bold"},Wt={class:"card"},Gt={class:"text-2xl font-bold text-yellow-400"},Qt={class:"card"},Ht={class:"text-2xl font-bold text-green-400"},Xt={class:"card"},Yt={class:"text-2xl font-bold text-orange-400"},Zt={class:"card"},te={class:"flex items-center gap-2"},ee={class:"text-2xl font-bold text-red-400"},se=["disabled"],oe={class:"card"},ne={class:"flex items-center justify-between mb-6"},le={class:"flex items-center gap-3"},ae={key:0,class:"flex items-center gap-2 text-xs text-night-400 bg-night-800 px-2 py-1 rounded-full"},ce={__name:"DashboardView",setup(A){const y=E(),n=S(),h=m(!1),u=m(!1),f=m(!1);let r=null;const c=I(()=>n.jobs.some(b=>b.status==="pending"||b.status==="processing")),v=I(()=>n.jobs.filter(b=>b.status==="needs_review").length);function x(){r||(f.value=!0,r=setInterval(async()=>{await n.fetchJobs(),c.value||p()},5e3))}function p(){r&&(clearInterval(r),r=null),f.value=!1}T(c,b=>{b?x():p()}),N(async()=>{await n.fetchJobs(),c.value&&x()}),O(()=>{p()});function _(){y.logout()}async function k(){u.value=!0;try{await n.retryAllFailed()}finally{u.value=!1}}return(b,s)=>{var e;const o=G("router-link");return l(),i("div",Ft,[t("header",It,[t("div",Nt,[t("div",Vt,[t("div",Mt,[s[7]||(s[7]=t("div",{class:"flex items-center"},[t("img",{src:B,alt:"Q",class:"w-8 h-8 -mr-0.5"}),t("h1",{class:"text-xl font-bold text-atlas-400"},"uickPRO")],-1)),t("nav",Bt,[$(o,{to:"/dashboard",class:"px-3 py-2 rounded-lg text-sm font-medium text-night-100 bg-night-800"},{default:J(()=>[...s[3]||(s[3]=[C(" Dashboard ",-1)])]),_:1}),$(o,{to:"/applications",class:"px-3 py-2 rounded-lg text-sm font-medium text-night-400 hover:text-night-100 hover:bg-night-800/50"},{default:J(()=>[...s[4]||(s[4]=[C(" Applications ",-1)])]),_:1}),$(o,{to:"/profile",class:"px-3 py-2 rounded-lg text-sm font-medium text-night-400 hover:text-night-100 hover:bg-night-800/50"},{default:J(()=>[...s[5]||(s[5]=[C(" Profile ",-1)])]),_:1}),$(o,{to:"/extension",class:"px-3 py-2 rounded-lg text-sm font-medium text-night-400 hover:text-night-100 hover:bg-night-800/50"},{default:J(()=>[...s[6]||(s[6]=[C(" Extension ",-1)])]),_:1})])]),t("div",zt,[t("span",Kt,d((e=g(y).user)==null?void 0:e.email),1),t("button",{onClick:_,class:"btn btn-ghost text-sm"}," Logout ")])])])]),t("main",qt,[t("div",Et,[t("div",Tt,[s[8]||(s[8]=t("p",{class:"text-sm text-night-400 mb-1"},"Saved Jobs",-1)),t("p",Ot,d(g(n).jobs.length),1)]),t("div",Wt,[s[9]||(s[9]=t("p",{class:"text-sm text-night-400 mb-1"},"Processing",-1)),t("p",Gt,d(g(n).pendingJobs.length),1)]),t("div",Qt,[s[10]||(s[10]=t("p",{class:"text-sm text-night-400 mb-1"},"Ready",-1)),t("p",Ht,d(g(n).completedJobs.length),1)]),t("div",Xt,[s[11]||(s[11]=t("p",{class:"text-sm text-night-400 mb-1"},"Needs Review",-1)),t("p",Yt,d(v.value),1)]),t("div",Zt,[s[12]||(s[12]=t("p",{class:"text-sm text-night-400 mb-1"},"Failed",-1)),t("div",te,[t("p",ee,d(g(n).failedJobs.length),1),g(n).failedJobs.length>0?(l(),i("button",{key:0,onClick:k,disabled:u.value,class:"text-xs px-2 py-1 bg-red-600 hover:bg-red-500 rounded text-white disabled:opacity-50"},d(u.value?"Retrying...":"Retry All"),9,se)):j("",!0)])]),s[13]||(s[13]=t("div",{class:"card"},[t("p",{class:"text-sm text-night-400 mb-1"},"Applications"),t("p",{class:"text-2xl font-bold text-atlas-400"},"0")],-1))]),t("div",oe,[t("div",ne,[t("div",le,[s[15]||(s[15]=t("h2",{class:"text-lg font-semibold"},"My Jobs",-1)),f.value?(l(),i("span",ae,[...s[14]||(s[14]=[t("span",{class:"w-2 h-2 bg-green-500 rounded-full animate-pulse"},null,-1),C(" Auto-refreshing ",-1)])])):j("",!0)]),t("button",{onClick:s[0]||(s[0]=a=>h.value=!0),class:"btn btn-accent"}," + Add Jobs ")]),$(bt,{jobs:g(n).jobs,loading:g(n).loading,onRefresh:g(n).fetchJobs},null,8,["jobs","loading","onRefresh"])])]),h.value?(l(),W(Dt,{key:0,onClose:s[1]||(s[1]=a=>h.value=!1),onSuccess:s[2]||(s[2]=a=>{g(n).fetchJobs(),h.value=!1})})):j("",!0)])}}};export{ce as default};
