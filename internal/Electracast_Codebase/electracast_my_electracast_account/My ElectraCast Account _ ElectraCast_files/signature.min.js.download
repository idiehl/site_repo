var URSignatures=window.URSignatures||function(i,e,t){"use strict";var n={config:{width:!1,changes:!1,pixelRatio:Math.max(e.devicePixelRatio||1,1)},signatures:{},signaturesDisabled:[],init:function(){n.ready(),t(e).on("user_registration_frontend_after_ajax_complete",function(i,e,n,a){t(".user-registration-signature-reset").each(function(){t(this).trigger("click")})})},ready:function(){n.config.width=t(e).width(),n.loadSignatures(),t(i).on("click",".user-registration-signature-reset",function(i){i.preventDefault(),n.resetSignature(t(this).parent().find(".user-registration-signature-canvas"))}),t(e).resize(n.resetSignatures),n.signaturesDisabled.length>0&&(n.config.changes=setInterval(n.signatureChanges,300)),t(i).on("ur-forms-signature-init",function(i,e){n.loadSignature(t(e))})},loadSignatures:function(){t(".user-registration-signature-canvas").each(function(){n.loadSignature(t(this))})},resetSignatures:function(){n.config.width!==t(e).width()&&t(".user-registration-signature-canvas").each(function(){n.resetSignature(t(this))})},getCanvas:function(i){var e=i.get(0);return e.width=e.offsetWidth*n.config.pixelRatio,e.height=e.offsetHeight*n.config.pixelRatio,e.getContext("2d").scale(n.config.pixelRatio,n.config.pixelRatio),e},loadSignature:function(i){var e=i.closest(".user-registration-field-signature").find(".user-registration-signature-input"),t=i.attr("id"),a=n.getCanvas(i);i.is(":hidden")?n.signaturesDisabled.push(t):n.signatures[t]=new SignaturePad(a,{onEnd:function(){var i=a.parentNode.getAttribute("data-image-format");e.val(this.toDataURL(i)).trigger("input change").valid()}})},resetSignature:function(i){var e=i.closest(".user-registration-field-signature").find(".user-registration-signature-input"),a=i.attr("id");n.getCanvas(i),n.signatures[a]&&n.signatures[a].clear(),e.val("").trigger("input change"),i.is(":hidden")&&(-1===t.inArray(a,n.signaturesDisabled)&&n.signaturesDisabled.push(a),n.signatures[a]&&delete n.signatures[a],n.config.changes||(n.config.changes=setInterval(n.signatureChanges,300)))},signatureChanges:function(){if(n.signaturesDisabled.length<1)return clearInterval(n.config.changes),void(n.config.changes=!1);for(var i in n.signaturesDisabled){var e=t("#"+n.signaturesDisabled[i]);e.is(":hidden")||(n.signaturesDisabled.splice(i,1),n.loadSignature(e))}}};return n}(document,window,jQuery);URSignatures.init();